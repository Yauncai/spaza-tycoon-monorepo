import{V as At,W as Le,i as Dt,X as Bt,x as E,q as Ut,Y as Ct,Z as Lt,n as w,_ as $t,$ as Ft,a0 as jt,a1 as zt,a2 as Tt,p as _,g as kt,a3 as Mt,e as F,A as Re,j as Vt,a4 as Ne,a5 as ee,a6 as k,a7 as S,a8 as $e,a9 as Rt,C as Nt,B as p,aa as nt,ab as _t,ac as at,ad as rt,ae as Ht,af as it,ag as Wt,ah as Jt,ai as $,o as Yt,b as Kt,k as B,u as Zt,w as Xt,aj as Qt,ak as qt,al as _e,am as en,an as tn,ao as nn,ap as an,l as rn,aq as sn,ar as on,as as fn,at as cn,au as un,av as Fe,aw as je,ax as dn,ay as ln,az as pn}from"./index-BoTpAOCD.js";function ja(e,t){if(e.length!==t.length)throw new At({expectedLength:e.length,givenLength:t.length});const n=[];for(let a=0;a<e.length;a++){const r=e[a],i=t[a];n.push(st(r,i))}return Le(n)}function st(e,t,n=!1){if(e==="address"){const s=t;if(!Dt(s))throw new Bt({address:s});return E(s.toLowerCase(),{size:n?32:null})}if(e==="string")return Ut(t);if(e==="bytes")return t;if(e==="bool")return E(Ct(t),{size:n?32:1});const a=e.match(Lt);if(a){const[s,o,f="256"]=a,c=Number.parseInt(f,10)/8;return w(t,{size:n?32:c,signed:o==="int"})}const r=e.match($t);if(r){const[s,o]=r;if(Number.parseInt(o,10)!==(t.length-2)/2)throw new Ft({expectedSize:Number.parseInt(o,10),givenSize:(t.length-2)/2});return E(t,{dir:"right",size:n?32:null})}const i=e.match(jt);if(i&&Array.isArray(t)){const[s,o]=i,f=[];for(let c=0;c<t.length;c++)f.push(st(o,t[c],!0));return f.length===0?"0x":Le(f)}throw new zt(e)}function yn(e){const{source:t}=e,n=new Map,a=new Tt(8192),r=new Map,i=({address:s,chainId:o})=>`${s}.${o}`;return{async consume({address:s,chainId:o,client:f}){const c=i({address:s,chainId:o}),d=this.get({address:s,chainId:o,client:f});this.increment({address:s,chainId:o});const m=await d;return await t.set({address:s,chainId:o},m),a.set(c,m),m},async increment({address:s,chainId:o}){const f=i({address:s,chainId:o}),c=n.get(f)??0;n.set(f,c+1)},async get({address:s,chainId:o,client:f}){const c=i({address:s,chainId:o});let d=r.get(c);return d||(d=(async()=>{try{const b=await t.get({address:s,chainId:o,client:f}),u=a.get(c)??0;return u>0&&b<=u?u+1:(a.delete(c),b)}finally{this.reset({address:s,chainId:o})}})(),r.set(c,d)),(n.get(c)??0)+await d},reset({address:s,chainId:o}){const f=i({address:s,chainId:o});n.delete(f),r.delete(f)}}}const mn="0x6492649264926492649264926492649264926492649264926492649264926492";function ie(e){const{address:t,data:n,signature:a,to:r="hex"}=e,i=Le([_([{type:"address"},{type:"bytes"},{type:"bytes"}],[t,n,a]),mn]);return r==="hex"?i:kt(i)}const gn="0x5792579257925792579257925792579257925792579257925792579257925792",bn=w(0,{size:32});async function hn(e,t){async function n(d){if(d.endsWith(gn.slice(2))){const b=Vt(Ne(d,-64,-32)),u=Ne(d,0,-64).slice(2).match(/.{1,64}/g),x=await Promise.all(u.map(g=>bn.slice(2)!==g?e.request({method:"eth_getTransactionReceipt",params:[`0x${g}`]},{dedupe:!0}):void 0)),l=x.some(g=>g===null)?100:x.every(g=>(g==null?void 0:g.status)==="0x1")?200:x.every(g=>(g==null?void 0:g.status)==="0x0")?500:600;return{atomic:!1,chainId:Re(b),receipts:x.filter(Boolean),status:l,version:"2.0.0"}}return e.request({method:"wallet_getCallsStatus",params:[d]})}const{atomic:a=!1,chainId:r,receipts:i,version:s="2.0.0",...o}=await n(t.id),[f,c]=(()=>{const d=o.status;return d>=100&&d<200?["pending",d]:d>=200&&d<300?["success",d]:d>=300&&d<700?["failure",d]:d==="CONFIRMED"?["success",200]:d==="PENDING"?["pending",100]:[void 0,d]})();return{...o,atomic:a,chainId:r?Re(r):void 0,receipts:(i==null?void 0:i.map(d=>({...d,blockNumber:F(d.blockNumber),gasUsed:F(d.gasUsed),status:Mt[d.status]})))??[],statusCode:c,status:f,version:s}}async function wn(e,t){var f;const{account:n=e.account,chainId:a,nonce:r}=t;if(!n)throw new ee({docsPath:"/docs/eip7702/prepareAuthorization"});const i=k(n),s=(()=>{if(t.executor)return t.executor==="self"?t.executor:k(t.executor)})(),o={address:t.contractAddress??t.address,chainId:a,nonce:r};return typeof o.chainId>"u"&&(o.chainId=((f=e.chain)==null?void 0:f.id)??await S(e,$e,"getChainId")({})),typeof o.nonce>"u"&&(o.nonce=await S(e,Rt,"getTransactionCount")({address:i.address,blockTag:"pending"}),(s==="self"||s!=null&&s.address&&Nt(s.address,i.address))&&(o.nonce+=1)),o}class xn extends p{constructor(t){super(`Call bundle failed with status: ${t.statusCode}`,{name:"BundleFailedError"}),Object.defineProperty(this,"result",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.result=t}}async function za(e,t){const{id:n,pollingInterval:a=e.pollingInterval,status:r=({statusCode:l})=>l===200||l>=300,retryCount:i=4,retryDelay:s=({count:l})=>~~(1<<l)*200,timeout:o=6e4,throwOnFailure:f=!1}=t,c=nt(["waitForCallsStatus",e.uid,n]),{promise:d,resolve:m,reject:b}=_t();let u;const x=at(c,{resolve:m,reject:b},l=>{const g=rt(async()=>{const G=y=>{clearTimeout(u),g(),y(),x()};try{const y=await Ht(async()=>{const P=await S(e,hn,"getCallsStatus")({id:n});if(f&&P.status==="failure")throw new xn(P);return P},{retryCount:i,delay:s});if(!r(y))return;G(()=>l.resolve(y))}catch(y){G(()=>l.reject(y))}},{interval:a,emitOnBegin:!0});return g});return u=o?setTimeout(()=>{x(),clearTimeout(u),b(new Pn({id:n}))},o):void 0,await d}class Pn extends p{constructor({id:t}){super(`Timed out while waiting for call bundle with id "${t}" to be confirmed.`,{name:"WaitForCallsStatusTimeoutError"})}}function Ta(e){const{key:t="public",name:n="Public Client"}=e;return it({...e,key:t,name:n,type:"publicClient"}).extend(Wt)}function ka(e){const{r:t,s:n}=Jt.Signature.fromCompact(e.slice(2,130)),a=+`0x${e.slice(130)}`,[r,i]=(()=>{if(a===0||a===1)return[void 0,a];if(a===27)return[BigInt(a),0];if(a===28)return[BigInt(a),1];throw new Error("Invalid yParityOrV value")})();return typeof r<"u"?{r:w(t,{size:32}),s:w(n,{size:32}),v:r,yParity:i}:{r:w(t,{size:32}),s:w(n,{size:32}),yParity:i}}function vn(e,t){let n;try{n=e()}catch{return}return{getItem:r=>{var i;const s=f=>f===null?null:JSON.parse(f,void 0),o=(i=n.getItem(r))!=null?i:null;return o instanceof Promise?o.then(s):s(o)},setItem:(r,i)=>n.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>n.removeItem(r)}}const fe=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(a){return fe(a)(n)},catch(a){return this}}}catch(n){return{then(a){return this},catch(a){return fe(a)(n)}}}},On=(e,t)=>(n,a,r)=>{let i={storage:vn(()=>localStorage),partialize:l=>l,version:0,merge:(l,g)=>({...g,...l}),...t},s=!1;const o=new Set,f=new Set;let c=i.storage;if(!c)return e((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...l)},a,r);const d=()=>{const l=i.partialize({...a()});return c.setItem(i.name,{state:l,version:i.version})},m=r.setState;r.setState=(l,g)=>{m(l,g),d()};const b=e((...l)=>{n(...l),d()},a,r);r.getInitialState=()=>b;let u;const x=()=>{var l,g;if(!c)return;s=!1,o.forEach(y=>{var P;return y((P=a())!=null?P:b)});const G=((g=i.onRehydrateStorage)==null?void 0:g.call(i,(l=a())!=null?l:b))||void 0;return fe(c.getItem.bind(c))(i.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate){const P=i.migrate(y.state,y.version);return P instanceof Promise?P.then(I=>[!0,I]):[!0,P]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var P;const[I,M]=y;if(u=i.merge(M,(P=a())!=null?P:b),n(u,!0),I)return d()}).then(()=>{G==null||G(u,void 0),u=a(),s=!0,f.forEach(y=>y(u))}).catch(y=>{G==null||G(void 0,y)})};return r.persist={setOptions:l=>{i={...i,...l},l.storage&&(c=l.storage)},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>s,onHydrate:l=>(o.add(l),()=>{o.delete(l)}),onFinishHydration:l=>(f.add(l),()=>{f.delete(l)})},i.skipHydration||x(),u||b},Ma=On,He=e=>{let t;const n=new Set,a=(c,d)=>{const m=typeof c=="function"?c(t):c;if(!Object.is(m,t)){const b=t;t=d??(typeof m!="object"||m===null)?m:Object.assign({},t,m),n.forEach(u=>u(t,b))}},r=()=>t,o={setState:a,getState:r,getInitialState:()=>f,subscribe:c=>(n.add(c),()=>n.delete(c))},f=t=e(a,r,o);return o},Va=e=>e?He(e):He;function te(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function Gn(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const a=te(n);return(r,i)=>a.then(s=>i(s.transaction(t,r).objectStore(t)))}let se;function ze(){return se||(se=Gn("keyval-store","keyval")),se}function Ra(e,t=ze()){return t("readonly",n=>te(n.get(e)))}function Na(e,t,n=ze()){return n("readwrite",a=>(a.put(t,e),te(a.transaction)))}function _a(e,t=ze()){return t("readwrite",n=>(n.delete(e),te(n.transaction)))}const Ha=[{inputs:[{name:"preOpGas",type:"uint256"},{name:"paid",type:"uint256"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"targetSuccess",type:"bool"},{name:"targetResult",type:"bytes"}],name:"ExecutionResult",type:"error"},{inputs:[{name:"opIndex",type:"uint256"},{name:"reason",type:"string"}],name:"FailedOp",type:"error"},{inputs:[{name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"},{inputs:[{name:"aggregator",type:"address"}],name:"SignatureValidationFailed",type:"error"},{inputs:[{components:[{name:"preOpGas",type:"uint256"},{name:"prefund",type:"uint256"},{name:"sigFailed",type:"bool"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"paymasterContext",type:"bytes"}],name:"returnInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"senderInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"factoryInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"paymasterInfo",type:"tuple"}],name:"ValidationResult",type:"error"},{inputs:[{components:[{name:"preOpGas",type:"uint256"},{name:"prefund",type:"uint256"},{name:"sigFailed",type:"bool"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"paymasterContext",type:"bytes"}],name:"returnInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"senderInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"factoryInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"paymasterInfo",type:"tuple"},{components:[{name:"aggregator",type:"address"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"stakeInfo",type:"tuple"}],name:"aggregatorInfo",type:"tuple"}],name:"ValidationResultWithAggregation",type:"error"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"factory",type:"address"},{indexed:!1,name:"paymaster",type:"address"}],name:"AccountDeployed",type:"event"},{anonymous:!1,inputs:[],name:"BeforeExecution",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalDeposit",type:"uint256"}],name:"Deposited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"aggregator",type:"address"}],name:"SignatureAggregatorChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalStaked",type:"uint256"},{indexed:!1,name:"unstakeDelaySec",type:"uint256"}],name:"StakeLocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawTime",type:"uint256"}],name:"StakeUnlocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"StakeWithdrawn",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!0,name:"paymaster",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"success",type:"bool"},{indexed:!1,name:"actualGasCost",type:"uint256"},{indexed:!1,name:"actualGasUsed",type:"uint256"}],name:"UserOperationEvent",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"revertReason",type:"bytes"}],name:"UserOperationRevertReason",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"Withdrawn",type:"event"},{inputs:[],name:"SIG_VALIDATION_FAILED",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"},{name:"sender",type:"address"},{name:"paymasterAndData",type:"bytes"}],name:"_validateSenderAndPaymaster",outputs:[],stateMutability:"view",type:"function"},{inputs:[{name:"unstakeDelaySec",type:"uint32"}],name:"addStake",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"depositTo",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"",type:"address"}],name:"deposits",outputs:[{name:"deposit",type:"uint112"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"getDepositInfo",outputs:[{components:[{name:"deposit",type:"uint112"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{name:"sender",type:"address"},{name:"key",type:"uint192"}],name:"getNonce",outputs:[{name:"nonce",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"}],name:"getSenderAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"getUserOpHash",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOps",type:"tuple[]"},{name:"aggregator",type:"address"},{name:"signature",type:"bytes"}],name:"opsPerAggregator",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleAggregatedOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"ops",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"key",type:"uint192"}],name:"incrementNonce",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"callData",type:"bytes"},{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"paymaster",type:"address"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"}],name:"mUserOp",type:"tuple"},{name:"userOpHash",type:"bytes32"},{name:"prefund",type:"uint256"},{name:"contextOffset",type:"uint256"},{name:"preOpGas",type:"uint256"}],name:"opInfo",type:"tuple"},{name:"context",type:"bytes"}],name:"innerHandleOp",outputs:[{name:"actualGasCost",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"",type:"address"},{name:"",type:"uint192"}],name:"nonceSequenceNumber",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"op",type:"tuple"},{name:"target",type:"address"},{name:"targetCallData",type:"bytes"}],name:"simulateHandleOp",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"simulateValidation",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unlockStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"}],name:"withdrawStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"},{name:"withdrawAmount",type:"uint256"}],name:"withdrawTo",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}],Wa="0x5FF137D4b0FDCD49DcA30c7CF57E578a026d2789";function ot(e,t={}){const{forHash:n}=t,{authorization:a,factory:r,factoryData:i}=e;return n&&(r==="0x7702"||r==="0x7702000000000000000000000000000000000000")?a?$([a.address,i??"0x"]):"0x7702000000000000000000000000000000000000":r?$([r,i??"0x"]):"0x"}const We="0x22e325a297439656";function ft(e,t={}){const{callGasLimit:n,callData:a,maxPriorityFeePerGas:r,maxFeePerGas:i,paymaster:s,paymasterData:o,paymasterPostOpGasLimit:f,paymasterSignature:c,paymasterVerificationGasLimit:d,sender:m,signature:b="0x",verificationGasLimit:u}=e,x=$([E(w(u||0n),{size:16}),E(w(n||0n),{size:16})]),l=ot(e,t),g=$([E(w(r||0n),{size:16}),E(w(i||0n),{size:16})]),G=e.nonce??0n,y=s?$([s,E(w(d||0n),{size:16}),E(w(f||0n),{size:16}),o||"0x",...c?t.forHash?[We]:[c,E(w(Yt(c)),{size:2}),We]:[]]):"0x",P=e.preVerificationGas??0n;return{accountGasLimits:x,callData:a,initCode:l,gasFees:g,nonce:G,paymasterAndData:y,preVerificationGas:P,sender:m,signature:b}}const En={PackedUserOperation:[{type:"address",name:"sender"},{type:"uint256",name:"nonce"},{type:"bytes",name:"initCode"},{type:"bytes",name:"callData"},{type:"bytes32",name:"accountGasLimits"},{type:"uint256",name:"preVerificationGas"},{type:"bytes32",name:"gasFees"},{type:"bytes",name:"paymasterAndData"}]};function Sn(e){const{chainId:t,entryPointAddress:n,userOperation:a}=e,r=ft(a,{forHash:!0});return{types:En,primaryType:"PackedUserOperation",domain:{name:"ERC4337",version:"1",chainId:t,verifyingContract:n},message:r}}function Ja(e){const{chainId:t,entryPointAddress:n,entryPointVersion:a}=e,r=e.userOperation,{authorization:i,callData:s="0x",callGasLimit:o,maxFeePerGas:f,maxPriorityFeePerGas:c,nonce:d,paymasterAndData:m="0x",preVerificationGas:b,sender:u,verificationGasLimit:x}=r;if(a==="0.8"||a==="0.9")return Kt(Sn({chainId:t,entryPointAddress:n,userOperation:r}));const l=(()=>{var g,G;if(a==="0.6"){const y=(g=r.initCode)==null?void 0:g.slice(0,42),P=(G=r.initCode)==null?void 0:G.slice(42),I=ot({authorization:i,factory:y,factoryData:P},{forHash:!0});return _([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"bytes32"}],[u,d,B(I),B(s),o,x,b,f,c,B(m)])}if(a==="0.7"){const y=ft(r,{forHash:!0});return _([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"}],[y.sender,y.nonce,B(y.initCode),B(y.callData),y.accountGasLimits,y.preVerificationGas,y.gasFees,B(y.paymasterAndData)])}throw new Error(`entryPointVersion "${a}" not supported.`)})();return B(_([{type:"bytes32"},{type:"address"},{type:"uint256"}],[B(l),n,BigInt(t)]))}async function Ya(e){const{extend:t,nonceKeyManager:n=yn({source:{get(){return Date.now()},set(){}}}),...a}=e;let r=!1;const i=await e.getAddress();return{...t,...a,address:i,async getFactoryArgs(){return"isDeployed"in this&&await this.isDeployed()?{factory:void 0,factoryData:void 0}:e.getFactoryArgs()},async getNonce(s){const o=(s==null?void 0:s.key)??BigInt(await n.consume({address:i,chainId:e.client.chain.id,client:e.client}));return e.getNonce?await e.getNonce({...s,key:o}):await Xt(e.client,{abi:Qt(["function getNonce(address, uint192) pure returns (uint256)"]),address:e.entryPoint.address,functionName:"getNonce",args:[i,o]})},async isDeployed(){return r?!0:(r=!!await S(e.client,Zt,"getCode")({address:i}),r)},...e.sign?{async sign(s){const[{factory:o,factoryData:f},c]=await Promise.all([this.getFactoryArgs(),e.sign(s)]);return o&&f?ie({address:o,data:f,signature:c}):c}}:{},async signMessage(s){const[{factory:o,factoryData:f},c]=await Promise.all([this.getFactoryArgs(),e.signMessage(s)]);return o&&f&&o!=="0x7702"?ie({address:o,data:f,signature:c}):c},async signTypedData(s){const[{factory:o,factoryData:f},c]=await Promise.all([this.getFactoryArgs(),e.signTypedData(s)]);return o&&f&&o!=="0x7702"?ie({address:o,data:f,signature:c}):c},type:"smart"}}class ce extends p{constructor({cause:t}){super("Smart Account is not deployed.",{cause:t,metaMessages:["This could arise when:","- No `factory`/`factoryData` or `initCode` properties are provided for Smart Account deployment.","- An incorrect `sender` address is provided."],name:"AccountNotDeployedError"})}}Object.defineProperty(ce,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa20/});class j extends p{constructor({cause:t,data:n,message:a}={}){var i;const r=(i=a==null?void 0:a.replace("execution reverted: ",""))==null?void 0:i.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:t,name:"ExecutionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n}}Object.defineProperty(j,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32521});Object.defineProperty(j,"message",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class ue extends p{constructor({cause:t}){super("Failed to send funds to beneficiary.",{cause:t,name:"FailedToSendToBeneficiaryError"})}}Object.defineProperty(ue,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa91/});class de extends p{constructor({cause:t}){super("Gas value overflowed.",{cause:t,metaMessages:["This could arise when:","- one of the gas values exceeded 2**120 (uint120)"].filter(Boolean),name:"GasValuesOverflowError"})}}Object.defineProperty(de,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa94/});class le extends p{constructor({cause:t}){super("The `handleOps` function was called by the Bundler with a gas limit too low.",{cause:t,name:"HandleOpsOutOfGasError"})}}Object.defineProperty(le,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa95/});class pe extends p{constructor({cause:t,factory:n,factoryData:a,initCode:r}){super("Failed to simulate deployment for Smart Account.",{cause:t,metaMessages:["This could arise when:","- Invalid `factory`/`factoryData` or `initCode` properties are present","- Smart Account deployment execution ran out of gas (low `verificationGasLimit` value)",`- Smart Account deployment execution reverted with an error
`,n&&`factory: ${n}`,a&&`factoryData: ${a}`,r&&`initCode: ${r}`].filter(Boolean),name:"InitCodeFailedError"})}}Object.defineProperty(pe,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa13/});class ye extends p{constructor({cause:t,factory:n,factoryData:a,initCode:r}){super("Smart Account initialization implementation did not create an account.",{cause:t,metaMessages:["This could arise when:","- `factory`/`factoryData` or `initCode` properties are invalid",`- Smart Account initialization implementation is incorrect
`,n&&`factory: ${n}`,a&&`factoryData: ${a}`,r&&`initCode: ${r}`].filter(Boolean),name:"InitCodeMustCreateSenderError"})}}Object.defineProperty(ye,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa15/});class me extends p{constructor({cause:t,factory:n,factoryData:a,initCode:r,sender:i}){super("Smart Account initialization implementation does not return the expected sender.",{cause:t,metaMessages:["This could arise when:",`Smart Account initialization implementation does not return a sender address
`,n&&`factory: ${n}`,a&&`factoryData: ${a}`,r&&`initCode: ${r}`,i&&`sender: ${i}`].filter(Boolean),name:"InitCodeMustReturnSenderError"})}}Object.defineProperty(me,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa14/});class ge extends p{constructor({cause:t}){super("Smart Account does not have sufficient funds to execute the User Operation.",{cause:t,metaMessages:["This could arise when:","- the Smart Account does not have sufficient funds to cover the required prefund, or","- a Paymaster was not provided"].filter(Boolean),name:"InsufficientPrefundError"})}}Object.defineProperty(ge,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa21/});class be extends p{constructor({cause:t}){super("Bundler attempted to call an invalid function on the EntryPoint.",{cause:t,name:"InternalCallOnlyError"})}}Object.defineProperty(be,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa92/});class he extends p{constructor({cause:t}){super("Bundler used an invalid aggregator for handling aggregated User Operations.",{cause:t,name:"InvalidAggregatorError"})}}Object.defineProperty(he,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa96/});class we extends p{constructor({cause:t,nonce:n}){super("Invalid Smart Account nonce used for User Operation.",{cause:t,metaMessages:[n&&`nonce: ${n}`].filter(Boolean),name:"InvalidAccountNonceError"})}}Object.defineProperty(we,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa25/});class xe extends p{constructor({cause:t}){super("Bundler has not set a beneficiary address.",{cause:t,name:"InvalidBeneficiaryError"})}}Object.defineProperty(xe,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa90/});class H extends p{constructor({cause:t}){super("Invalid fields set on User Operation.",{cause:t,name:"InvalidFieldsError"})}}Object.defineProperty(H,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class Pe extends p{constructor({cause:t,paymasterAndData:n}){super("Paymaster properties provided are invalid.",{cause:t,metaMessages:["This could arise when:","- the `paymasterAndData` property is of an incorrect length\n",n&&`paymasterAndData: ${n}`].filter(Boolean),name:"InvalidPaymasterAndDataError"})}}Object.defineProperty(Pe,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa93/});class L extends p{constructor({cause:t}){super("Paymaster deposit for the User Operation is too low.",{cause:t,metaMessages:["This could arise when:","- the Paymaster has deposited less than the expected amount via the `deposit` function"].filter(Boolean),name:"PaymasterDepositTooLowError"})}}Object.defineProperty(L,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32508});Object.defineProperty(L,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa31/});class ve extends p{constructor({cause:t}){super("The `validatePaymasterUserOp` function on the Paymaster reverted.",{cause:t,name:"PaymasterFunctionRevertedError"})}}Object.defineProperty(ve,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa33/});class Oe extends p{constructor({cause:t}){super("The Paymaster contract has not been deployed.",{cause:t,name:"PaymasterNotDeployedError"})}}Object.defineProperty(Oe,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa30/});class W extends p{constructor({cause:t}){super("UserOperation rejected because paymaster (or signature aggregator) is throttled/banned.",{cause:t,name:"PaymasterRateLimitError"})}}Object.defineProperty(W,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32504});class J extends p{constructor({cause:t}){super("UserOperation rejected because paymaster (or signature aggregator) is throttled/banned.",{cause:t,name:"PaymasterStakeTooLowError"})}}Object.defineProperty(J,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32505});class Ge extends p{constructor({cause:t}){super("Paymaster `postOp` function reverted.",{cause:t,name:"PaymasterPostOpFunctionRevertedError"})}}Object.defineProperty(Ge,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa50/});class Ee extends p{constructor({cause:t,factory:n,factoryData:a,initCode:r}){super("Smart Account has already been deployed.",{cause:t,metaMessages:["Remove the following properties and try again:",n&&"`factory`",a&&"`factoryData`",r&&"`initCode`"].filter(Boolean),name:"SenderAlreadyConstructedError"})}}Object.defineProperty(Ee,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa10/});class Y extends p{constructor({cause:t}){super("UserOperation rejected because account signature check failed (or paymaster signature, if the paymaster uses its data as signature).",{cause:t,name:"SignatureCheckFailedError"})}}Object.defineProperty(Y,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32507});class Se extends p{constructor({cause:t}){super("The `validateUserOp` function on the Smart Account reverted.",{cause:t,name:"SmartAccountFunctionRevertedError"})}}Object.defineProperty(Se,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa23/});class K extends p{constructor({cause:t}){super("UserOperation rejected because account specified unsupported signature aggregator.",{cause:t,name:"UnsupportedSignatureAggregatorError"})}}Object.defineProperty(K,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32506});class Ie extends p{constructor({cause:t}){super("User Operation expired.",{cause:t,metaMessages:["This could arise when:","- the `validAfter` or `validUntil` values returned from `validateUserOp` on the Smart Account are not satisfied"].filter(Boolean),name:"UserOperationExpiredError"})}}Object.defineProperty(Ie,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa22/});class Ae extends p{constructor({cause:t}){super("Paymaster for User Operation expired.",{cause:t,metaMessages:["This could arise when:","- the `validAfter` or `validUntil` values returned from `validatePaymasterUserOp` on the Paymaster are not satisfied"].filter(Boolean),name:"UserOperationPaymasterExpiredError"})}}Object.defineProperty(Ae,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa32/});class De extends p{constructor({cause:t}){super("Signature provided for the User Operation is invalid.",{cause:t,metaMessages:["This could arise when:","- the `signature` for the User Operation is incorrectly computed, and unable to be verified by the Smart Account"].filter(Boolean),name:"UserOperationSignatureError"})}}Object.defineProperty(De,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa24/});class Be extends p{constructor({cause:t}){super("Signature provided for the User Operation is invalid.",{cause:t,metaMessages:["This could arise when:","- the `signature` for the User Operation is incorrectly computed, and unable to be verified by the Paymaster"].filter(Boolean),name:"UserOperationPaymasterSignatureError"})}}Object.defineProperty(Be,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa34/});class Z extends p{constructor({cause:t}){super("User Operation rejected by EntryPoint's `simulateValidation` during account creation or validation.",{cause:t,name:"UserOperationRejectedByEntryPointError"})}}Object.defineProperty(Z,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32500});class X extends p{constructor({cause:t}){super("User Operation rejected by Paymaster's `validatePaymasterUserOp`.",{cause:t,name:"UserOperationRejectedByPaymasterError"})}}Object.defineProperty(X,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32501});class Q extends p{constructor({cause:t}){super("User Operation rejected with op code validation error.",{cause:t,name:"UserOperationRejectedByOpCodeError"})}}Object.defineProperty(Q,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32502});class q extends p{constructor({cause:t}){super("UserOperation out of time-range: either wallet or paymaster returned a time-range, and it is already expired (or will expire soon).",{cause:t,name:"UserOperationOutOfTimeRangeError"})}}Object.defineProperty(q,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32503});class In extends p{constructor({cause:t}){super(`An error occurred while executing user operation: ${t==null?void 0:t.shortMessage}`,{cause:t,name:"UnknownBundlerError"})}}class Ue extends p{constructor({cause:t}){super("User Operation verification gas limit exceeded.",{cause:t,metaMessages:["This could arise when:","- the gas used for verification exceeded the `verificationGasLimit`"].filter(Boolean),name:"VerificationGasLimitExceededError"})}}Object.defineProperty(Ue,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa40/});class Ce extends p{constructor({cause:t}){super("User Operation verification gas limit is too low.",{cause:t,metaMessages:["This could arise when:","- the `verificationGasLimit` is too low to verify the User Operation"].filter(Boolean),name:"VerificationGasLimitTooLowError"})}}Object.defineProperty(Ce,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa41/});class An extends p{constructor(t,{callData:n,callGasLimit:a,docsPath:r,factory:i,factoryData:s,initCode:o,maxFeePerGas:f,maxPriorityFeePerGas:c,nonce:d,paymaster:m,paymasterAndData:b,paymasterData:u,paymasterPostOpGasLimit:x,paymasterVerificationGasLimit:l,preVerificationGas:g,sender:G,signature:y,verificationGasLimit:P}){const I=qt({callData:n,callGasLimit:a,factory:i,factoryData:s,initCode:o,maxFeePerGas:typeof f<"u"&&`${_e(f)} gwei`,maxPriorityFeePerGas:typeof c<"u"&&`${_e(c)} gwei`,nonce:d,paymaster:m,paymasterAndData:b,paymasterData:u,paymasterPostOpGasLimit:x,paymasterVerificationGasLimit:l,preVerificationGas:g,sender:G,signature:y,verificationGasLimit:P});super(t.shortMessage,{cause:t,docsPath:r,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Request Arguments:",I].filter(Boolean),name:"UserOperationExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=t}}class Dn extends p{constructor({hash:t}){super(`User Operation receipt with hash "${t}" could not be found. The User Operation may not have been processed yet.`,{name:"UserOperationReceiptNotFoundError"})}}class Bn extends p{constructor({hash:t}){super(`User Operation with hash "${t}" could not be found.`,{name:"UserOperationNotFoundError"})}}class Je extends p{constructor({hash:t}){super(`Timed out while waiting for User Operation with hash "${t}" to be confirmed.`,{name:"WaitForUserOperationReceiptTimeoutError"})}}const Un=[j,H,L,W,J,Y,K,q,Z,X,Q];function Cn(e,t){const n=(e.details||"").toLowerCase();if(ce.message.test(n))return new ce({cause:e});if(ue.message.test(n))return new ue({cause:e});if(de.message.test(n))return new de({cause:e});if(le.message.test(n))return new le({cause:e});if(pe.message.test(n))return new pe({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(ye.message.test(n))return new ye({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(me.message.test(n))return new me({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode,sender:t.sender});if(ge.message.test(n))return new ge({cause:e});if(be.message.test(n))return new be({cause:e});if(we.message.test(n))return new we({cause:e,nonce:t.nonce});if(he.message.test(n))return new he({cause:e});if(xe.message.test(n))return new xe({cause:e});if(Pe.message.test(n))return new Pe({cause:e});if(L.message.test(n))return new L({cause:e});if(ve.message.test(n))return new ve({cause:e});if(Oe.message.test(n))return new Oe({cause:e});if(Ge.message.test(n))return new Ge({cause:e});if(Se.message.test(n))return new Se({cause:e});if(Ee.message.test(n))return new Ee({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(Ie.message.test(n))return new Ie({cause:e});if(Ae.message.test(n))return new Ae({cause:e});if(Be.message.test(n))return new Be({cause:e});if(De.message.test(n))return new De({cause:e});if(Ue.message.test(n))return new Ue({cause:e});if(Ce.message.test(n))return new Ce({cause:e});const a=e.walk(r=>Un.some(i=>i.code===r.code));if(a){if(a.code===j.code)return new j({cause:e,data:a.data,message:a.details});if(a.code===H.code)return new H({cause:e});if(a.code===L.code)return new L({cause:e});if(a.code===W.code)return new W({cause:e});if(a.code===J.code)return new J({cause:e});if(a.code===Y.code)return new Y({cause:e});if(a.code===K.code)return new K({cause:e});if(a.code===q.code)return new q({cause:e});if(a.code===Z.code)return new Z({cause:e});if(a.code===X.code)return new X({cause:e});if(a.code===Q.code)return new Q({cause:e})}return new In({cause:e})}function ct(e,{calls:t,docsPath:n,...a}){const r=(()=>{const i=Cn(e,a);if(t&&i instanceof j){const s=Ln(i),o=t==null?void 0:t.filter(f=>f.abi);if(s&&o.length>0)return $n({calls:o,revertData:s})}return i})();return new An(r,{docsPath:n,...a})}function Ln(e){let t;return e.walk(n=>{var r,i,s,o;const a=n;if(typeof a.data=="string"||typeof((r=a.data)==null?void 0:r.revertData)=="string"||!(a instanceof p)&&typeof a.message=="string"){const f=(o=(s=((i=a.data)==null?void 0:i.revertData)||a.data||a.message).match)==null?void 0:o.call(s,/(0x[A-Za-z0-9]*)/);if(f)return t=f[1],!0}return!1}),t}function $n(e){const{calls:t,revertData:n}=e,{abi:a,functionName:r,args:i,to:s}=(()=>{const f=t==null?void 0:t.filter(d=>!!d.abi);if(f.length===1)return f[0];const c=f.filter(d=>{try{return!!en({abi:d.abi,data:n})}catch{return!1}});return c.length===1?c[0]:{abi:[],functionName:f.reduce((d,m)=>`${d?`${d} | `:""}${m.functionName}`,""),args:void 0,to:void 0}})(),o=n==="0x"?new tn({functionName:r}):new nn({abi:a,data:n,functionName:r});return new an(o,{abi:a,args:i,contractAddress:s,functionName:r})}function Fn(e){const t={};return e.callGasLimit&&(t.callGasLimit=BigInt(e.callGasLimit)),e.preVerificationGas&&(t.preVerificationGas=BigInt(e.preVerificationGas)),e.verificationGasLimit&&(t.verificationGasLimit=BigInt(e.verificationGasLimit)),e.paymasterPostOpGasLimit&&(t.paymasterPostOpGasLimit=BigInt(e.paymasterPostOpGasLimit)),e.paymasterVerificationGasLimit&&(t.paymasterVerificationGasLimit=BigInt(e.paymasterVerificationGasLimit)),t}function ne(e){const t={};return typeof e.callData<"u"&&(t.callData=e.callData),typeof e.callGasLimit<"u"&&(t.callGasLimit=w(e.callGasLimit)),typeof e.factory<"u"&&(t.factory=e.factory),typeof e.factoryData<"u"&&(t.factoryData=e.factoryData),typeof e.initCode<"u"&&(t.initCode=e.initCode),typeof e.maxFeePerGas<"u"&&(t.maxFeePerGas=w(e.maxFeePerGas)),typeof e.maxPriorityFeePerGas<"u"&&(t.maxPriorityFeePerGas=w(e.maxPriorityFeePerGas)),typeof e.nonce<"u"&&(t.nonce=w(e.nonce)),typeof e.paymaster<"u"&&(t.paymaster=e.paymaster),typeof e.paymasterAndData<"u"&&(t.paymasterAndData=e.paymasterAndData||"0x"),typeof e.paymasterData<"u"&&(t.paymasterData=e.paymasterData),typeof e.paymasterPostOpGasLimit<"u"&&(t.paymasterPostOpGasLimit=w(e.paymasterPostOpGasLimit)),typeof e.paymasterSignature<"u"&&(t.paymasterSignature=e.paymasterSignature),typeof e.paymasterVerificationGasLimit<"u"&&(t.paymasterVerificationGasLimit=w(e.paymasterVerificationGasLimit)),typeof e.preVerificationGas<"u"&&(t.preVerificationGas=w(e.preVerificationGas)),typeof e.sender<"u"&&(t.sender=e.sender),typeof e.signature<"u"&&(t.signature=e.signature),typeof e.verificationGasLimit<"u"&&(t.verificationGasLimit=w(e.verificationGasLimit)),typeof e.authorization<"u"&&(t.eip7702Auth=jn(e.authorization)),t}function jn(e){return{address:e.address,chainId:w(e.chainId),nonce:w(e.nonce),r:e.r?w(BigInt(e.r),{size:32}):E("0x",{size:32}),s:e.s?w(BigInt(e.s),{size:32}):E("0x",{size:32}),yParity:e.yParity?w(e.yParity,{size:1}):E("0x",{size:32})}}async function zn(e,t){const{chainId:n,entryPointAddress:a,context:r,...i}=t,s=ne(i),{paymasterPostOpGasLimit:o,paymasterVerificationGasLimit:f,...c}=await e.request({method:"pm_getPaymasterData",params:[{...s,callGasLimit:s.callGasLimit??"0x0",verificationGasLimit:s.verificationGasLimit??"0x0",preVerificationGas:s.preVerificationGas??"0x0"},a,w(n),r]});return{...c,...o&&{paymasterPostOpGasLimit:F(o)},...f&&{paymasterVerificationGasLimit:F(f)}}}async function Tn(e,t){const{chainId:n,entryPointAddress:a,context:r,...i}=t,s=ne(i),{paymasterPostOpGasLimit:o,paymasterVerificationGasLimit:f,...c}=await e.request({method:"pm_getPaymasterStubData",params:[{...s,callGasLimit:s.callGasLimit??"0x0",verificationGasLimit:s.verificationGasLimit??"0x0",preVerificationGas:s.preVerificationGas??"0x0"},a,w(n),r]});return{...c,...o&&{paymasterPostOpGasLimit:F(o)},...f&&{paymasterVerificationGasLimit:F(f)}}}const kn=["factory","fees","gas","paymaster","nonce","signature","authorization"];async function Te(e,t){var Ve;const n=t,{account:a=e.account,parameters:r=kn,stateOverride:i}=n;if(!a)throw new ee;const s=k(a),o=e,f=n.paymaster??(o==null?void 0:o.paymaster),c=typeof f=="string"?f:void 0,{getPaymasterStubData:d,getPaymasterData:m}=(()=>{if(f===!0)return{getPaymasterStubData:h=>S(o,Tn,"getPaymasterStubData")(h),getPaymasterData:h=>S(o,zn,"getPaymasterData")(h)};if(typeof f=="object"){const{getPaymasterStubData:h,getPaymasterData:O}=f;return{getPaymasterStubData:O&&h?h:O,getPaymasterData:O&&h?O:void 0}}return{getPaymasterStubData:void 0,getPaymasterData:void 0}})(),b=n.paymasterContext?n.paymasterContext:o==null?void 0:o.paymasterContext;let u={...n,paymaster:c,sender:s.address};const[x,l,g,G,y]=await Promise.all([(async()=>n.calls?s.encodeCalls(n.calls.map(h=>{const O=h;return O.abi?{data:rn(O),to:O.to,value:O.value}:O})):n.callData)(),(async()=>{if(!r.includes("factory"))return;if(n.initCode)return{initCode:n.initCode};if(n.factory&&n.factoryData)return{factory:n.factory,factoryData:n.factoryData};const{factory:h,factoryData:O}=await s.getFactoryArgs();return s.entryPoint.version==="0.6"?{initCode:h&&O?$([h,O]):void 0}:{factory:h,factoryData:O}})(),(async()=>{var h;if(r.includes("fees")){if(typeof n.maxFeePerGas=="bigint"&&typeof n.maxPriorityFeePerGas=="bigint")return u;if((h=o==null?void 0:o.userOperation)!=null&&h.estimateFeesPerGas){const O=await o.userOperation.estimateFeesPerGas({account:s,bundlerClient:o,userOperation:u});return{...u,...O}}try{const O=o.client??e,V=await S(O,sn,"estimateFeesPerGas")({chain:O.chain,type:"eip1559"});return{maxFeePerGas:typeof n.maxFeePerGas=="bigint"?n.maxFeePerGas:BigInt(2n*V.maxFeePerGas),maxPriorityFeePerGas:typeof n.maxPriorityFeePerGas=="bigint"?n.maxPriorityFeePerGas:BigInt(2n*V.maxPriorityFeePerGas)}}catch{return}}})(),(async()=>{if(r.includes("nonce"))return typeof n.nonce=="bigint"?n.nonce:s.getNonce()})(),(async()=>{if(r.includes("authorization")){if(typeof n.authorization=="object")return n.authorization;if(s.authorization&&!await s.isDeployed())return{...await wn(s.client,s.authorization),r:"0xfffffffffffffffffffffffffffffff000000000000000000000000000000000",s:"0x7aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",yParity:1}}})()]);typeof x<"u"&&(u.callData=x),typeof l<"u"&&(u={...u,...l}),typeof g<"u"&&(u={...u,...g}),typeof G<"u"&&(u.nonce=G),typeof y<"u"&&(u.authorization=y),r.includes("signature")&&(typeof n.signature<"u"?u.signature=n.signature:u.signature=await s.getStubSignature(u)),s.entryPoint.version==="0.6"&&!u.initCode&&(u.initCode="0x");let P;async function I(){return P||(e.chain?e.chain.id:(P=await S(e,$e,"getChainId")({}),P))}let M=!1;if(r.includes("paymaster")&&d&&!c&&!n.paymasterAndData){const{isFinal:h=!1,sponsor:O,...V}=await d({chainId:await I(),entryPointAddress:s.entryPoint.address,context:b,...u});M=h,u={...u,...V}}if(s.entryPoint.version==="0.6"&&!u.paymasterAndData&&(u.paymasterAndData="0x"),r.includes("gas")){if((Ve=s.userOperation)!=null&&Ve.estimateGas){const h=await s.userOperation.estimateGas(u);u={...u,...h}}if(typeof u.callGasLimit>"u"||typeof u.preVerificationGas>"u"||typeof u.verificationGasLimit>"u"||u.paymaster&&typeof u.paymasterPostOpGasLimit>"u"||u.paymaster&&typeof u.paymasterVerificationGasLimit>"u"){const h=await S(o,ut,"estimateUserOperationGas")({account:s,callGasLimit:0n,preVerificationGas:0n,verificationGasLimit:0n,stateOverride:i,...u.paymaster?{paymasterPostOpGasLimit:0n,paymasterVerificationGasLimit:0n}:{},...u});u={...u,callGasLimit:u.callGasLimit??h.callGasLimit,preVerificationGas:u.preVerificationGas??h.preVerificationGas,verificationGasLimit:u.verificationGasLimit??h.verificationGasLimit,paymasterPostOpGasLimit:u.paymasterPostOpGasLimit??h.paymasterPostOpGasLimit,paymasterVerificationGasLimit:u.paymasterVerificationGasLimit??h.paymasterVerificationGasLimit}}}if(r.includes("paymaster")&&m&&!c&&!n.paymasterAndData&&!M){const h=await m({chainId:await I(),entryPointAddress:s.entryPoint.address,context:b,...u});u={...u,...h}}return delete u.calls,delete u.parameters,delete u.paymasterContext,typeof u.paymaster!="string"&&delete u.paymaster,u}async function ut(e,t){var f;const{account:n=e.account,entryPointAddress:a,stateOverride:r}=t;if(!n&&!t.sender)throw new ee;const i=n?k(n):void 0,s=on(r),o=i?await S(e,Te,"prepareUserOperation")({...t,parameters:["authorization","factory","nonce","paymaster","signature"]}):t;try{const c=[ne(o),a??((f=i==null?void 0:i.entryPoint)==null?void 0:f.address)],d=await e.request({method:"eth_estimateUserOperationGas",params:s?[...c,s]:[...c]});return Fn(d)}catch(c){const d=t.calls;throw ct(c,{...o,...d?{calls:d}:{}})}}function Mn(e){return e.request({method:"eth_supportedEntryPoints"})}function Vn(e){const t={...e};return e.callGasLimit&&(t.callGasLimit=BigInt(e.callGasLimit)),e.maxFeePerGas&&(t.maxFeePerGas=BigInt(e.maxFeePerGas)),e.maxPriorityFeePerGas&&(t.maxPriorityFeePerGas=BigInt(e.maxPriorityFeePerGas)),e.nonce&&(t.nonce=BigInt(e.nonce)),e.paymasterPostOpGasLimit&&(t.paymasterPostOpGasLimit=BigInt(e.paymasterPostOpGasLimit)),e.paymasterVerificationGasLimit&&(t.paymasterVerificationGasLimit=BigInt(e.paymasterVerificationGasLimit)),e.preVerificationGas&&(t.preVerificationGas=BigInt(e.preVerificationGas)),e.verificationGasLimit&&(t.verificationGasLimit=BigInt(e.verificationGasLimit)),t}async function Rn(e,{hash:t}){const n=await e.request({method:"eth_getUserOperationByHash",params:[t]},{dedupe:!0});if(!n)throw new Bn({hash:t});const{blockHash:a,blockNumber:r,entryPoint:i,transactionHash:s,userOperation:o}=n;return{blockHash:a,blockNumber:BigInt(r),entryPoint:i,transactionHash:s,userOperation:Vn(o)}}function Nn(e){const t={...e};return e.actualGasCost&&(t.actualGasCost=BigInt(e.actualGasCost)),e.actualGasUsed&&(t.actualGasUsed=BigInt(e.actualGasUsed)),e.logs&&(t.logs=e.logs.map(n=>fn(n))),e.receipt&&(t.receipt=cn(t.receipt)),t}async function dt(e,{hash:t}){const n=await e.request({method:"eth_getUserOperationReceipt",params:[t]},{dedupe:!0});if(!n)throw new Dn({hash:t});return Nn(n)}async function _n(e,t){var f,c;const{account:n=e.account,entryPointAddress:a}=t;if(!n&&!t.sender)throw new ee;const r=n?k(n):void 0,i=r?await S(e,Te,"prepareUserOperation")(t):t,s=t.signature||await((f=r==null?void 0:r.signUserOperation)==null?void 0:f.call(r,i)),o=ne({...i,signature:s});try{return await e.request({method:"eth_sendUserOperation",params:[o,a??((c=r==null?void 0:r.entryPoint)==null?void 0:c.address)]},{retryCount:0})}catch(d){const m=t.calls;throw ct(d,{...i,...m?{calls:m}:{},signature:s})}}function Hn(e,t){const{hash:n,pollingInterval:a=e.pollingInterval,retryCount:r,timeout:i=12e4}=t;let s=0;const o=nt(["waitForUserOperationReceipt",e.uid,n]);return new Promise((f,c)=>{const d=at(o,{resolve:f,reject:c},m=>{const b=l=>{x(),l(),d()},u=i?setTimeout(()=>b(()=>m.reject(new Je({hash:n}))),i):void 0,x=rt(async()=>{r&&s>=r&&(clearTimeout(u),b(()=>m.reject(new Je({hash:n}))));try{const l=await S(e,dt,"getUserOperationReceipt")({hash:n});clearTimeout(u),b(()=>m.resolve(l))}catch(l){const g=l;g.name!=="UserOperationReceiptNotFoundError"&&(clearTimeout(u),b(()=>m.reject(g)))}s++},{emitOnBegin:!0,interval:a});return x})})}function Wn(e){return{estimateUserOperationGas:t=>ut(e,t),getChainId:()=>$e(e),getSupportedEntryPoints:()=>Mn(e),getUserOperation:t=>Rn(e,t),getUserOperationReceipt:t=>dt(e,t),prepareUserOperation:t=>Te(e,t),sendUserOperation:t=>_n(e,t),waitForUserOperationReceipt:t=>Hn(e,t)}}function Ka(e){const{client:t,key:n="bundler",name:a="Bundler Client",paymaster:r,paymasterContext:i,transport:s,userOperation:o}=e;return Object.assign(it({...e,chain:e.chain??(t==null?void 0:t.chain),key:n,name:a,transport:s,type:"bundlerClient"}),{client:t,paymaster:r,paymasterContext:i,userOperation:o}).extend(Wn)}const Jn="0.1.1";function Yn(){return Jn}class v extends Error{constructor(t,n={}){const a=(()=>{var f;if(n.cause instanceof v){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return(f=n.cause)!=null&&f.message?n.cause.message:n.details})(),r=n.cause instanceof v&&n.cause.docsPath||n.docsPath,s=`https://oxlib.sh${r??""}`,o=[t||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...a||r?["",a?`Details: ${a}`:void 0,r?`See: ${s}`:void 0]:[]].filter(f=>typeof f=="string").join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${Yn()}`}),this.cause=n.cause,this.details=a,this.docs=s,this.docsPath=r,this.shortMessage=t}walk(t){return lt(this,t)}}function lt(e,t){return t!=null&&t(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause?lt(e.cause,t):t?null:e}const Kn="#__bigint";function ae(e,t,n){return JSON.stringify(e,(a,r)=>typeof r=="bigint"?r.toString()+Kn:r,n)}function Zn(e,t){if(T(e)>t)throw new la({givenSize:T(e),maxSize:t})}function Xn(e,t){if(typeof t=="number"&&t>0&&t>T(e)-1)throw new Pt({offset:t,position:"start",size:T(e)})}function Qn(e,t,n){if(typeof t=="number"&&typeof n=="number"&&T(e)!==n-t)throw new Pt({offset:n,position:"end",size:T(e)})}const A={zero:48,nine:57,A:65,F:70,a:97,f:102};function Ye(e){if(e>=A.zero&&e<=A.nine)return e-A.zero;if(e>=A.A&&e<=A.F)return e-(A.A-10);if(e>=A.a&&e<=A.f)return e-(A.a-10)}function ke(e,t){if(C(e)>t)throw new fa({givenSize:C(e),maxSize:t})}function qn(e,t){if(typeof t=="number"&&t>0&&t>C(e)-1)throw new bt({offset:t,position:"start",size:C(e)})}function ea(e,t,n){if(typeof t=="number"&&typeof n=="number"&&C(e)!==n-t)throw new bt({offset:n,position:"end",size:C(e)})}function pt(e,t={}){const{dir:n,size:a=32}=t;if(a===0)return e;const r=e.replace("0x","");if(r.length>a*2)throw new ca({size:Math.ceil(r.length/2),targetSize:a,type:"Hex"});return`0x${r[n==="right"?"padEnd":"padStart"](a*2,"0")}`}const ta=new TextEncoder,na=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function aa(e,t={}){const{strict:n=!1}=t;if(!e)throw new Ke(e);if(typeof e!="string")throw new Ke(e);if(n&&!/^0x[0-9a-fA-F]*$/.test(e))throw new Ze(e);if(!e.startsWith("0x"))throw new Ze(e)}function re(...e){return`0x${e.reduce((t,n)=>t+n.replace("0x",""),"")}`}function yt(e){return e instanceof Uint8Array?z(e):Array.isArray(e)?z(new Uint8Array(e)):e}function z(e,t={}){let n="";for(let r=0;r<e.length;r++)n+=na[e[r]];const a=`0x${n}`;return typeof t.size=="number"?(ke(a,t.size),gt(a,t.size)):a}function U(e,t={}){const{signed:n,size:a}=t,r=BigInt(e);let i;a?n?i=(1n<<BigInt(a)*8n-1n)-1n:i=2n**(BigInt(a)*8n)-1n:typeof e=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const s=typeof i=="bigint"&&n?-i-1n:0;if(i&&r>i||r<s){const c=typeof e=="bigint"?"n":"";throw new oa({max:i?`${i}${c}`:void 0,min:`${s}${c}`,signed:n,size:a,value:`${e}${c}`})}const f=`0x${(n&&r<0?(1n<<BigInt(a*8))+BigInt(r):r).toString(16)}`;return a?ra(f,a):f}function mt(e,t={}){return z(ta.encode(e),t)}function ra(e,t){return pt(e,{dir:"left",size:t})}function gt(e,t){return pt(e,{dir:"right",size:t})}function D(e,t,n,a={}){const{strict:r}=a;qn(e,t);const i=`0x${e.replace("0x","").slice((t??0)*2,(n??e.length)*2)}`;return r&&ea(i,t,n),i}function C(e){return Math.ceil((e.length-2)/2)}function ia(e,t={}){const{signed:n}=t;t.size&&ke(e,t.size);const a=BigInt(e);if(!n)return a;const r=(e.length-2)/2,i=(1n<<BigInt(r)*8n)-1n,s=i>>1n;return a<=s?a:a-i-1n}function sa(e,t={}){const{strict:n=!1}=t;try{return aa(e,{strict:n}),!0}catch{return!1}}class oa extends v{constructor({max:t,min:n,signed:a,size:r,value:i}){super(`Number \`${i}\` is not in safe${r?` ${r*8}-bit`:""}${a?" signed":" unsigned"} integer range ${t?`(\`${n}\` to \`${t}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class Ke extends v{constructor(t){super(`Value \`${typeof t=="object"?ae(t):t}\` of type \`${typeof t}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class Ze extends v{constructor(t){super(`Value \`${t}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let fa=class extends v{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${t}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}},bt=class extends v{constructor({offset:t,position:n,size:a}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${t}\` is out-of-bounds (size: \`${a}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}};class ca extends v{constructor({size:t,targetSize:n,type:a}){super(`${a.charAt(0).toUpperCase()}${a.slice(1).toLowerCase()} size (\`${t}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}function ua(e){if(!(e instanceof Uint8Array)){if(!e)throw new R(e);if(typeof e!="object")throw new R(e);if(!("BYTES_PER_ELEMENT"in e))throw new R(e);if(e.BYTES_PER_ELEMENT!==1||e.constructor.name!=="Uint8Array")throw new R(e)}}function ht(e){return e instanceof Uint8Array?e:typeof e=="string"?xt(e):wt(e)}function wt(e){return e instanceof Uint8Array?e:new Uint8Array(e)}function xt(e,t={}){const{size:n}=t;let a=e;n&&(ke(e,n),a=gt(e,n));let r=a.slice(2);r.length%2&&(r=`0${r}`);const i=r.length/2,s=new Uint8Array(i);for(let o=0,f=0;o<i;o++){const c=Ye(r.charCodeAt(f++)),d=Ye(r.charCodeAt(f++));if(c===void 0||d===void 0)throw new v(`Invalid byte sequence ("${r[f-2]}${r[f-1]}" in "${r}").`);s[o]=c*16+d}return s}function T(e){return e.length}function Xe(e,t,n,a={}){const{strict:r}=a;Xn(e,t);const i=e.slice(t,n);return r&&Qn(i,t,n),i}function Qe(e,t={}){const{size:n}=t;typeof n<"u"&&Zn(e,n);const a=z(e,t);return ia(a,t)}function da(e){try{return ua(e),!0}catch{return!1}}class R extends v{constructor(t){super(`Value \`${typeof t=="object"?ae(t):t}\` of type \`${typeof t}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class la extends v{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${t}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class Pt extends v{constructor({offset:t,position:n,size:a}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${t}\` is out-of-bounds (size: \`${a}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SliceOffsetOutOfBoundsError"})}}function vt(e,t={}){const{as:n=typeof e=="string"?"Hex":"Bytes"}=t,a=un(ht(e));return n==="Bytes"?a:z(a)}function Ot(e,t={}){const{compressed:n}=t,{prefix:a,x:r,y:i}=e;if(n===!1||typeof r=="bigint"&&typeof i=="bigint"){if(a!==4)throw new qe({prefix:a,cause:new ba});return}if(n===!0||typeof r=="bigint"&&typeof i>"u"){if(a!==3&&a!==2)throw new qe({prefix:a,cause:new ga});return}throw new ma({publicKey:e})}function pa(e){const t=(()=>{if(sa(e))return Gt(e);if(da(e))return ya(e);const{prefix:n,x:a,y:r}=e;return typeof a=="bigint"&&typeof r=="bigint"?{prefix:n??4,x:a,y:r}:{prefix:n,x:a}})();return Ot(t),t}function ya(e){return Gt(z(e))}function Gt(e){if(e.length!==132&&e.length!==130&&e.length!==68)throw new ha({publicKey:e});if(e.length===130){const a=BigInt(D(e,0,32)),r=BigInt(D(e,32,64));return{prefix:4,x:a,y:r}}if(e.length===132){const a=Number(D(e,0,1)),r=BigInt(D(e,1,33)),i=BigInt(D(e,33,65));return{prefix:a,x:r,y:i}}const t=Number(D(e,0,1)),n=BigInt(D(e,1,33));return{prefix:t,x:n}}function Qa(e,t={}){Ot(e);const{prefix:n,x:a,y:r}=e,{includePrefix:i=!0}=t;return re(i?U(n,{size:1}):"0x",U(a,{size:32}),typeof r=="bigint"?U(r,{size:32}):"0x")}class ma extends v{constructor({publicKey:t}){super(`Value \`${ae(t)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class qe extends v{constructor({prefix:t,cause:n}){super(`Prefix "${t}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class ga extends v{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class ba extends v{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}let ha=class extends v{constructor({publicKey:t}){super(`Value \`${t}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${C(yt(t))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const et=2n**256n-1n;function wa(e,t={}){const{recovered:n}=t;if(typeof e.r>"u")throw new oe({signature:e});if(typeof e.s>"u")throw new oe({signature:e});if(n&&typeof e.yParity>"u")throw new oe({signature:e});if(e.r<0n||e.r>et)throw new Oa({value:e.r});if(e.s<0n||e.s>et)throw new Ga({value:e.s});if(typeof e.yParity=="number"&&e.yParity!==0&&e.yParity!==1)throw new Me({value:e.yParity})}function er(e){if(e.length!==130&&e.length!==132)throw new va({signature:e});const t=BigInt(D(e,0,32)),n=BigInt(D(e,32,64)),a=(()=>{const r=+`0x${e.slice(130)}`;if(!Number.isNaN(r))try{return xa(r)}catch{throw new Me({value:r})}})();return typeof a>"u"?{r:t,s:n}:{r:t,s:n,yParity:a}}function tr(e){wa(e);const t=e.r,n=e.s;return re(U(t,{size:32}),U(n,{size:32}),typeof e.yParity=="number"?U(Pa(e.yParity),{size:1}):"0x")}function xa(e){if(e===0||e===27)return 0;if(e===1||e===28)return 1;if(e>=35)return e%2===0?1:0;throw new Ea({value:e})}function Pa(e){if(e===0)return 27;if(e===1)return 28;throw new Me({value:e})}class va extends v{constructor({signature:t}){super(`Value \`${t}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${C(yt(t))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class oe extends v{constructor({signature:t}){super(`Signature \`${ae(t)}\` is missing either an \`r\`, \`s\`, or \`yParity\` property.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.MissingPropertiesError"})}}class Oa extends v{constructor({value:t}){super(`Value \`${t}\` is an invalid r value. r must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidRError"})}}class Ga extends v{constructor({value:t}){super(`Value \`${t}\` is an invalid s value. s must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSError"})}}class Me extends v{constructor({value:t}){super(`Value \`${t}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class Ea extends v{constructor({value:t}){super(`Value \`${t}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}const Sa=new TextDecoder,N=Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((e,t)=>[t,e.charCodeAt(0)]));({...Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((e,t)=>[e.charCodeAt(0),t]))});function Ia(e,t={}){const{pad:n=!0,url:a=!1}=t,r=new Uint8Array(Math.ceil(e.length/3)*4);for(let f=0,c=0;c<e.length;f+=4,c+=3){const d=(e[c]<<16)+(e[c+1]<<8)+(e[c+2]|0);r[f]=N[d>>18],r[f+1]=N[d>>12&63],r[f+2]=N[d>>6&63],r[f+3]=N[d&63]}const i=e.length%3,s=Math.floor(e.length/3)*4+(i&&i+1);let o=Sa.decode(new Uint8Array(r.buffer,0,s));return n&&i===1&&(o+="=="),n&&i===2&&(o+="="),a&&(o=o.replaceAll("+","-").replaceAll("/","_")),o}function Aa(e,t={}){return Ia(xt(e),t)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Et={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},St={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},It={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Da=je(Et.p),Ba=je(St.p),Ua=je(It.p),Ca=Fe({...Et,Fp:Da,lowS:!1},dn);Fe({...St,Fp:Ba,lowS:!1},ln);Fe({...It,Fp:Ua,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},pn);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const tt=Ca;Uint8Array.from([105,171,180,181,160,222,75,198,42,42,32,31,141,37,186,233]);function La(e={}){const{flag:t=5,rpId:n=window.location.hostname,signCount:a=0}=e,r=vt(mt(n)),i=U(t,{size:1}),s=U(a,{size:4});return re(r,i,s)}function $a(e){const{challenge:t,crossOrigin:n=!1,extraClientData:a,origin:r=window.location.origin}=e;return JSON.stringify({type:"webauthn.get",challenge:Aa(t,{url:!0,pad:!1}),origin:r,crossOrigin:n,...a})}function nr(e){const{challenge:t,crossOrigin:n,extraClientData:a,flag:r,origin:i,rpId:s,signCount:o,userVerification:f="required"}=e,c=La({flag:r,rpId:s,signCount:o}),d=$a({challenge:t,crossOrigin:n,extraClientData:a,origin:i}),m=vt(mt(d)),b=d.indexOf('"challenge"'),u=d.indexOf('"type"'),x={authenticatorData:c,clientDataJSON:d,challengeIndex:b,typeIndex:u,userVerificationRequired:f==="required"},l=re(c,m);return{metadata:x,payload:l}}async function ar(e={}){const{extractable:t=!1}=e,n=await globalThis.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},t,["sign","verify"]),a=await globalThis.crypto.subtle.exportKey("raw",n.publicKey),r=pa(new Uint8Array(a));return{privateKey:n.privateKey,publicKey:r}}async function rr(e){const{payload:t,privateKey:n}=e,a=await globalThis.crypto.subtle.sign({name:"ECDSA",hash:"SHA-256"},n,ht(t)),r=wt(new Uint8Array(a)),i=Qe(Xe(r,0,32));let s=Qe(Xe(r,32,64));return s>tt.CURVE.n/2n&&(s=tt.CURVE.n-s),{r:i,s}}export{vn as a,Ta as b,Va as c,Ka as d,Gn as e,_a as f,Ra as g,D as h,nr as i,rr as j,tr as k,ar as l,er as m,Ya as n,Wa as o,Ma as p,Ha as q,Ja as r,Na as s,Qa as t,ka as u,ja as v,za as w};
